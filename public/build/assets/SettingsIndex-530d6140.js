import{r as l,s as u,z as y,m as w,a as v,c as m,b as _,d as e,e as B,F as k,o as p,t as c,B as C,f as h}from"./app-76e40468.js";const P={class:"profilePage"},S={class:"container-fluid"},A={class:"card mt-3"},$={class:"card-body"},F=["disabled"],M={key:0,class:"mt-3"},N={class:"text-muted"},V={class:"progress mt-2"},z=["aria-valuenow"],D={key:0,class:"list-group mt-4"},E=["href"],H=["href"],I=["href"],f="Configurações",T={__name:"SettingsIndex",setup(L){l({name:u.value.name||"",email:u.value.email||"",photo:y||""});const g=w(()=>{var a,s;return(s=(a=u.value)==null?void 0:a.roles)==null?void 0:s.includes("admin")}),i=l(!1),n=l(0),t=l(""),b=async()=>{if(!i.value){i.value=!0,n.value=0,t.value="Preparando lista de músicas...";try{const a=await fetch("/offline/songs");if(!a.ok){t.value="Falha ao buscar músicas para offline.";return}const s=await a.json(),o=(s==null?void 0:s.songs)??[],d=o.length||1;for(let r=0;r<o.length;r+=1){const x=o[r];t.value=`Baixando ${r+1} de ${o.length}...`,await fetch(`/offline/songs/${x.id}`),n.value=Math.round((r+1)/d*100)}t.value="Músicas prontas para uso offline!"}catch(a){console.error(a),t.value="Erro ao baixar músicas para offline."}finally{i.value=!1}}};return(a,s)=>{const o=v("AppHead"),d=v("LayoutSubPages");return p(),m(k,null,[_(o,{title:f}),e("div",P,[_(d,{title:f},{default:B(()=>[e("div",S,[e("h2",null,c(f)),e("div",A,[e("div",$,[s[0]||(s[0]=e("h5",{class:"card-title"},"Offline",-1)),s[1]||(s[1]=e("p",{class:"text-muted"},"Baixe todas as músicas para usar o app sem internet.",-1)),e("button",{class:"btn btn-primary",type:"button",disabled:i.value,onClick:b},c(i.value?"Baixando...":"Baixar tudo para offline"),9,F),t.value?(p(),m("div",M,[e("small",N,c(t.value),1),e("div",V,[e("div",{class:"progress-bar",role:"progressbar",style:C({width:`${n.value}%`}),"aria-valuenow":n.value,"aria-valuemin":"0","aria-valuemax":"100"},c(n.value)+"% ",13,z)])])):h("",!0)])]),g.value?(p(),m("div",D,[e("a",{href:a.route("admin.imports.index"),class:"list-group-item list-group-item-action"}," Importar músicas (Admin) ",8,E),e("a",{href:a.route("admin.sources.index"),class:"list-group-item list-group-item-action"}," Gerenciar fontes externas ",8,H),e("a",{href:a.route("admin.corrections.index"),class:"list-group-item list-group-item-action"}," Revisar correções de cifras ",8,I)])):h("",!0)])]),_:1})])],64)}}};export{T as default};
