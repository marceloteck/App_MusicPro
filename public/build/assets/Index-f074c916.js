import{_ as R,T as p,r as v,m as J,a as h,c as u,b as y,e as O,F as S,o as i,d as e,w as x,g as r,v as d,u as n,j as k,f as g,l as F,t as m,n as I}from"./app-76e40468.js";const P={class:"container-fluid"},T={class:"row"},M={class:"col-lg-6"},X={class:"card mb-4"},z={class:"card-body"},D={class:"form-check mt-2"},H=["disabled"],$={class:"col-lg-6"},j={key:0,class:"card mb-4"},G={class:"card-body"},K={class:"form-check mt-2"},Q=["disabled"],W={class:"card"},Y={class:"card-body p-0"},Z={class:"table mb-0"},ee={class:"text-break"},te={class:"text-break"},se=["onClick"],le=["onClick"],ae={key:0},U="Fontes externas",oe={__name:"Index",props:{sources:{type:Array,default:()=>[]}},setup(V){const f=V,_={result_item:"//div[contains(@class,'item') or contains(@class,'result')]",result_link:".//a",result_title:".//*[self::h1 or self::h2 or self::h3]",result_artist:".//*[contains(@class,'artist') or contains(@class,'autor')]"},o=p({name:"",base_url:"",search_url:"",enabled:!0,selectors:{..._}}),l=v(null),b=v(JSON.stringify(o.selectors,null,2)),c=v(""),N=a=>{l.value=p({name:a.name,base_url:a.base_url,search_url:a.search_url,enabled:a.enabled,selectors:a.selectors||{..._}}),l.value.id=a.id,c.value=JSON.stringify(l.value.selectors,null,2)},C=()=>{try{o.selectors=JSON.parse(b.value||"{}")}catch{alert("Seletores inválidos. Verifique o JSON.");return}o.post(route("admin.sources.store"),{preserveScroll:!0,onSuccess:()=>o.reset("name","base_url","search_url")})},A=()=>{var a;if((a=l.value)!=null&&a.id){try{l.value.selectors=JSON.parse(c.value||"{}")}catch{alert("Seletores inválidos. Verifique o JSON.");return}l.value.put(route("admin.sources.update",l.value.id),{preserveScroll:!0})}},L=a=>{confirm("Remover esta fonte?")&&p({}).delete(route("admin.sources.destroy",a),{preserveScroll:!0})},q=J(()=>{var a;return!!((a=l.value)!=null&&a.id)});return(a,t)=>{const w=h("AppHead"),B=h("LayoutSubPages");return i(),u(S,null,[y(w,{title:U}),y(B,{title:U},{default:O(()=>[e("div",P,[t[19]||(t[19]=e("p",{class:"text-muted"}," Cadastre fontes externas informando URLs de busca e seletores XPath para capturar títulos, artistas e links de cifras. ",-1)),e("div",T,[e("div",M,[e("div",X,[e("div",z,[t[12]||(t[12]=e("h5",{class:"card-title"},"Nova fonte",-1)),e("form",{onSubmit:x(C,["prevent"])},[r(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n(o).name=s),class:"form-control",placeholder:"Nome",required:""},null,512),[[d,n(o).name]]),r(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n(o).base_url=s),class:"form-control",placeholder:"Base URL",required:""},null,512),[[d,n(o).base_url]]),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n(o).search_url=s),class:"form-control",placeholder:"URL de busca (use {query})"},null,512),[[d,n(o).search_url]]),t[11]||(t[11]=e("label",{class:"form-label"},"Seletores XPath",-1)),r(e("textarea",{class:"form-control",rows:"6","onUpdate:modelValue":t[3]||(t[3]=s=>b.value=s)},null,512),[[d,b.value]]),e("div",D,[r(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=s=>n(o).enabled=s),id:"enabled"},null,512),[[k,n(o).enabled]]),t[10]||(t[10]=e("label",{class:"form-check-label",for:"enabled"},"Ativo",-1))]),e("button",{class:"btn btn-primary mt-3",type:"submit",disabled:n(o).processing}," Salvar ",8,H)],32)])])]),e("div",$,[q.value?(i(),u("div",j,[e("div",G,[t[15]||(t[15]=e("h5",{class:"card-title"},"Editar fonte",-1)),e("form",{onSubmit:x(A,["prevent"])},[r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.name=s),class:"form-control",placeholder:"Nome",required:""},null,512),[[d,l.value.name]]),r(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.base_url=s),class:"form-control",placeholder:"Base URL",required:""},null,512),[[d,l.value.base_url]]),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.search_url=s),class:"form-control",placeholder:"URL de busca"},null,512),[[d,l.value.search_url]]),t[14]||(t[14]=e("label",{class:"form-label"},"Seletores XPath",-1)),r(e("textarea",{class:"form-control",rows:"6","onUpdate:modelValue":t[8]||(t[8]=s=>c.value=s)},null,512),[[d,c.value]]),e("div",K,[r(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=s=>l.value.enabled=s),id:"enabledEdit"},null,512),[[k,l.value.enabled]]),t[13]||(t[13]=e("label",{class:"form-check-label",for:"enabledEdit"},"Ativo",-1))]),e("button",{class:"btn btn-primary mt-3",type:"submit",disabled:l.value.processing}," Atualizar ",8,Q)],32)])])):g("",!0)])]),e("div",W,[t[18]||(t[18]=e("div",{class:"card-header"},"Fontes cadastradas",-1)),e("div",Y,[e("table",Z,[t[17]||(t[17]=e("thead",null,[e("tr",null,[e("th",null,"Nome"),e("th",null,"Base"),e("th",null,"Busca"),e("th",null,"Status"),e("th",null,"Ações")])],-1)),e("tbody",null,[(i(!0),u(S,null,F(f.sources,s=>(i(),u("tr",{key:s.id},[e("td",null,m(s.name),1),e("td",ee,m(s.base_url),1),e("td",te,m(s.search_url),1),e("td",null,[e("span",{class:I(["badge",s.enabled?"bg-success":"bg-secondary"])},m(s.enabled?"Ativo":"Inativo"),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:E=>N(s)}," Editar ",8,se),e("button",{class:"btn btn-sm btn-outline-danger",onClick:E=>L(s.id)}," Remover ",8,le)])]))),128)),f.sources.length===0?(i(),u("tr",ae,t[16]||(t[16]=[e("td",{colspan:"5",class:"text-center text-muted"}," Nenhuma fonte cadastrada ainda. ",-1)]))):g("",!0)])])])])])]),_:1})],64)}}},ne=R(oe,[["__scopeId","data-v-8bf6c308"]]);export{ne as default};
