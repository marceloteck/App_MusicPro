import{_ as O,Q as W,m as X,r as p,p as Y,T as Z,q as ee,s as g,a as k,c as o,b as M,d as s,e as se,x as ae,f as m,F as x,o as l,t as v,n as T,h as I,l as V,g as B,v as D,u as r,j as te,y as E}from"./app-76e40468.js";const ne={class:"IndexBands"},le={key:0,class:"alert alert-danger"},oe={class:"tabs"},ie={key:1,class:"tab-content"},de={class:"bands-grid"},re={class:"band-actions"},ue=["href"],ce=["onClick"],pe=["onClick"],ve={key:2,class:"tab-content"},be={key:0,class:"list-form"},me={class:"form-check mt-2"},_e={class:"list-form-actions"},fe=["disabled"],ke={class:"lists-grid"},ye={class:"list-actions"},Ce=["onClick","disabled"],he=["onClick"],ge=["onClick","disabled"],Me={__name:"Index",props:{bands:{type:Array,default:()=>[]},userLists:{type:Array,default:()=>[]}},setup(y){const L=y,R=W(),w=X(()=>{var a;return((a=R.props.flash)==null?void 0:a.error)||null}),i=p("bands"),$=Y(),C=p(null),h=p(null),b=p(null),u=p(!1),c=p(null),n=Z({name:"",description:"",is_public:!1});ee(()=>{g.value&&$.setUser(g.value)});const A=a=>$.checkUserRole(a),S=a=>{var e;return(a==null?void 0:a.user_id)===((e=g.value)==null?void 0:e.id)},U=a=>{const e=`${window.location.origin}/bands/${a.id}`;navigator.clipboard.writeText(e).catch(()=>{window.prompt("Copie o link da banda:",e)})},F=a=>{confirm("Deseja excluir esta lista?")&&n.delete(route("playlists.destroy",a),{preserveScroll:!0})},j=a=>{c.value=a,n.name=a.name,n.description=a.description||"",n.is_public=!!a.is_public,u.value=!0},q=a=>{const e=`${window.location.origin}/player?playlist=${a}`;navigator.clipboard.writeText(e).catch(()=>{window.prompt("Copie o link da lista:",e)})},H=()=>{C.value&&C.value.ExecuteCreateBandModal()},P=a=>{if(!a||!a.id){console.error("Dados da banda inválidos");return}b.value=null,E(()=>{var e;b.value={...a,members:((e=a.members)==null?void 0:e.map(d=>{var _;return{...d,user:d.user||{},user_id:d.user_id||((_=d.user)==null?void 0:_.id)}}))||[]},E(()=>{h.value?h.value.ExecuteManageBandModal():console.error("Modal não encontrado")})})},z=a=>{const e=L.bands.findIndex(d=>d.id===a);e!==-1&&L.bands.splice(e,1),b.value=null},G=()=>{if(c.value){n.put(route("playlists.update",c.value.id),{preserveScroll:!0,onSuccess:()=>{u.value=!1,c.value=null,n.reset()}});return}n.post(route("playlists.store"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,n.reset()}})},Q=()=>{c.value=null,n.reset(),u.value=!0};return(a,e)=>{const d=k("AppHead"),_=k("LayoutIndexPages"),J=k("CreateBandModal"),K=k("ManageBandModal");return l(),o(x,null,[M(d,{title:"Bandas e Listas de Músicas"}),s("div",ne,[M(_,null,{default:se(()=>[w.value?(l(),o("div",le,v(w.value),1)):m("",!0),s("div",oe,[s("button",{class:T({active:i.value==="bands"}),onClick:e[0]||(e[0]=t=>i.value="bands"),onTouchstart:e[1]||(e[1]=t=>i.value="bands")},e[8]||(e[8]=[s("span",{class:"material-symbols-outlined"},"groups",-1),s("span",null,"Minhas Bandas",-1)]),34),s("button",{class:T({active:i.value==="lists"}),onClick:e[2]||(e[2]=t=>i.value="lists"),onTouchstart:e[3]||(e[3]=t=>i.value="lists")},e[9]||(e[9]=[s("span",{class:"material-symbols-outlined"},"playlist_play",-1),s("span",null,"Minhas Listas",-1)]),34)]),i.value==="bands"?(l(),o("div",ie,[s("div",{class:"header-actions"},[e[11]||(e[11]=s("h1",null,"Minhas Bandas",-1)),s("button",{class:"btn-create",onClick:H},e[10]||(e[10]=[s("span",{class:"material-symbols-outlined"},"add",-1),I(" Nova Banda ")]))]),s("div",de,[(l(!0),o(x,null,V(y.bands,t=>(l(),o("div",{key:t.id,class:"band-card"},[s("h3",null,v(t.name),1),s("p",null,"Seu papel: "+v(A(t)),1),s("div",re,[s("a",{href:"/bands/"+t.id,class:"btn-view"},"Ver Banda",8,ue),s("button",{onClick:f=>U(t),class:"btn-share"},"Compartilhar",8,ce),s("button",{onClick:f=>P(t),class:"btn-manage"},e[12]||(e[12]=[s("span",{class:"material-symbols-outlined"},"settings",-1),I(" Gerenciar ")]),8,pe)])]))),128))])])):m("",!0),i.value==="lists"?(l(),o("div",ve,[e[14]||(e[14]=s("h1",null,"Minhas Listas de Músicas",-1)),s("button",{class:"btn-create",onClick:Q},"Criar Nova Lista"),u.value?(l(),o("div",be,[s("h4",null,v(c.value?"Editar lista":"Nova lista"),1),B(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>r(n).name=t),class:"form-control",placeholder:"Nome",required:""},null,512),[[D,r(n).name]]),B(s("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>r(n).description=t),class:"form-control",placeholder:"Descrição (opcional)",rows:"3"},null,512),[[D,r(n).description]]),s("label",me,[B(s("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>r(n).is_public=t),class:"form-check-input",type:"checkbox"},null,512),[[te,r(n).is_public]]),e[13]||(e[13]=s("span",{class:"form-check-label"},"Lista pública",-1))]),s("div",_e,[s("button",{class:"btn btn-primary",onClick:G,disabled:r(n).processing}," Salvar ",8,fe),s("button",{class:"btn btn-outline-secondary",onClick:e[7]||(e[7]=t=>u.value=!1)}," Cancelar ")])])):m("",!0),s("div",ke,[(l(!0),o(x,null,V(y.userLists,t=>{var f;return l(),o("div",{key:t.id,class:"list-card"},[s("h3",null,v(t.name),1),s("p",null,v(((f=t.songs)==null?void 0:f.length)||0)+" músicas",1),s("div",ye,[s("button",{onClick:N=>j(t),class:"btn-edit",disabled:!S(t)},"Editar",8,Ce),s("button",{onClick:N=>q(t.id),class:"btn-share"},"Compartilhar",8,he),s("button",{onClick:N=>F(t.id),class:"btn-delete",disabled:!S(t)},"Excluir",8,ge)])])}),128))])])):m("",!0)]),_:1}),M(J,{ref_key:"createBandModalRef",ref:C},null,512),b.value?(l(),ae(K,{key:0,ref_key:"manageBandModalRef",ref:h,band:b.value,onBandDeleted:z},null,8,["band"])):m("",!0)])],64)}}},Be=O(Me,[["__scopeId","data-v-e85a1155"]]);export{Be as default};
