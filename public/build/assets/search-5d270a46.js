import{_ as S,r,a as C,c as a,b as E,d as t,e as T,F as g,o,n as B,g as q,v as F,A as I,t as l,f as h,l as j}from"./app-0b8657a5.js";const V={class:"indexSearch"},$={class:"container"},P={class:"tabs"},A={key:0},K={class:"input-group mt-3"},L=["disabled"],M={key:0,class:"text-danger mt-3"},R={key:1,class:"list-group mt-4"},U={class:"d-flex justify-content-between align-items-center"},D={class:"mb-1"},O={class:"text-muted"},H={key:0,class:"mb-0 mt-2 text-muted"},z=["href"],J={key:2,class:"text-muted mt-4"},Q={key:1},X={class:"input-group mt-3"},G=["disabled"],W={key:0,class:"text-danger mt-3"},Y={key:1,class:"text-success mt-3"},Z={key:2,class:"list-group mt-4"},ee={class:"d-flex justify-content-between align-items-center"},te={class:"mb-1"},se={class:"text-muted"},ae=["onClick"],oe={key:3,class:"text-muted mt-4"},ne={__name:"search",setup(le){const y=r(""),b=r([]),d=r(!1),m=r(""),f=r(""),x=r([]),v=r(!1),_=r(""),c=r(""),i=r("local"),k=async()=>{m.value="",d.value=!0;try{const n=await fetch(`/offline/songs?q=${encodeURIComponent(y.value)}`);if(!n.ok)throw new Error("Falha ao buscar músicas.");const s=await n.json();b.value=(s==null?void 0:s.songs)??[]}catch(n){m.value=n.message??"Erro ao buscar músicas."}finally{d.value=!1}},w=async()=>{_.value="",v.value=!0;try{const n=await fetch(`/search/external/results?q=${encodeURIComponent(f.value)}`);if(!n.ok)throw new Error("Falha ao buscar em sites externos.");const s=await n.json();x.value=(s==null?void 0:s.results)??[]}catch(n){_.value=n.message??"Erro ao buscar fontes externas."}finally{v.value=!1}},N=async n=>{var s;c.value="";try{const u=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.content,p=await fetch("/search/external/import",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u||""},body:JSON.stringify({url:n})}),e=await p.json();if(!p.ok)throw new Error((e==null?void 0:e.message)||"Falha ao importar.");c.value=(e==null?void 0:e.message)||"Música importada com sucesso."}catch(u){c.value=u.message||"Erro ao importar música."}};return(n,s)=>{const u=C("AppHead"),p=C("LayoutIndexPages");return o(),a(g,null,[E(u,{title:"Pesquisar"}),t("div",V,[E(p,null,{default:T(()=>[t("div",$,[s[4]||(s[4]=t("h1",null,"Pesquisar músicas",-1)),t("div",P,[t("button",{class:B(["tab",{active:i.value==="local"}]),onClick:s[0]||(s[0]=e=>i.value="local")}," No app ",2),t("button",{class:B(["tab",{active:i.value==="external"}]),onClick:s[1]||(s[1]=e=>i.value="external")}," Internet ",2)]),i.value==="local"?(o(),a("div",A,[t("div",K,[q(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>y.value=e),class:"form-control",placeholder:"Digite o título ou trecho da letra",onKeyup:I(k,["enter"])},null,544),[[F,y.value]]),t("button",{class:"btn btn-primary",disabled:d.value,onClick:k},l(d.value?"Buscando...":"Buscar"),9,L)]),m.value?(o(),a("p",M,l(m.value),1)):h("",!0),b.value.length?(o(),a("div",R,[(o(!0),a(g,null,j(b.value,e=>(o(),a("div",{key:e.id,class:"list-group-item"},[t("div",U,[t("div",null,[t("h5",D,l(e.title),1),t("small",O,l(e.artist),1),e.lyrics?(o(),a("p",H,l(e.lyrics.slice(0,120))+"... ",1)):h("",!0)]),t("a",{class:"btn btn-outline-secondary",href:`/songs/${e.id}`}," Ver detalhes ",8,z)])]))),128))])):(o(),a("p",J,"Faça uma busca para ver resultados."))])):(o(),a("div",Q,[t("div",X,[q(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>f.value=e),class:"form-control",placeholder:"Buscar em sites externos",onKeyup:I(w,["enter"])},null,544),[[F,f.value]]),t("button",{class:"btn btn-primary",disabled:v.value,onClick:w},l(v.value?"Buscando...":"Buscar"),9,G)]),_.value?(o(),a("p",W,l(_.value),1)):h("",!0),c.value?(o(),a("p",Y,l(c.value),1)):h("",!0),x.value.length?(o(),a("div",Z,[(o(!0),a(g,null,j(x.value,e=>(o(),a("div",{key:e.url,class:"list-group-item"},[t("div",ee,[t("div",null,[t("h5",te,l(e.title||"Título não identificado"),1),t("small",se,l(e.artist||"Artista não identificado")+" · "+l(e.source),1)]),t("button",{class:"btn btn-outline-primary",onClick:re=>N(e.url)}," Importar ",8,ae)])]))),128))])):(o(),a("p",oe,"Busque para ver fontes externas disponíveis."))]))])]),_:1})])],64)}}},ie=S(ne,[["__scopeId","data-v-6e832a62"]]);export{ie as default};
