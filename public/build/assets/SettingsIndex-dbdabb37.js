import{r,s as u,z as y,m as w,a as v,c as m,b as _,d as a,e as B,F as k,o as p,t as c,B as C,f as g}from"./app-7df99663.js";const P={class:"profilePage"},S={class:"container-fluid"},A={class:"card mt-3"},$={class:"card-body"},F=["disabled"],M={key:0,class:"mt-3"},N={class:"text-muted"},V={class:"progress mt-2"},z=["aria-valuenow"],D={key:0,class:"list-group mt-4"},E=["href"],f="Configurações",L={__name:"SettingsIndex",setup(H){r({name:u.value.name||"",email:u.value.email||"",photo:y||""});const h=w(()=>{var e,s;return(s=(e=u.value)==null?void 0:e.roles)==null?void 0:s.includes("admin")}),n=r(!1),l=r(0),t=r(""),b=async()=>{if(!n.value){n.value=!0,l.value=0,t.value="Preparando lista de músicas...";try{const e=await fetch("/offline/songs");if(!e.ok){t.value="Falha ao buscar músicas para offline.";return}const s=await e.json(),o=(s==null?void 0:s.songs)??[],d=o.length||1;for(let i=0;i<o.length;i+=1){const x=o[i];t.value=`Baixando ${i+1} de ${o.length}...`,await fetch(`/offline/songs/${x.id}`),l.value=Math.round((i+1)/d*100)}t.value="Músicas prontas para uso offline!"}catch(e){console.error(e),t.value="Erro ao baixar músicas para offline."}finally{n.value=!1}}};return(e,s)=>{const o=v("AppHead"),d=v("LayoutSubPages");return p(),m(k,null,[_(o,{title:f}),a("div",P,[_(d,{title:f},{default:B(()=>[a("div",S,[a("h2",null,c(f)),a("div",A,[a("div",$,[s[0]||(s[0]=a("h5",{class:"card-title"},"Offline",-1)),s[1]||(s[1]=a("p",{class:"text-muted"},"Baixe todas as músicas para usar o app sem internet.",-1)),a("button",{class:"btn btn-primary",type:"button",disabled:n.value,onClick:b},c(n.value?"Baixando...":"Baixar tudo para offline"),9,F),t.value?(p(),m("div",M,[a("small",N,c(t.value),1),a("div",V,[a("div",{class:"progress-bar",role:"progressbar",style:C({width:`${l.value}%`}),"aria-valuenow":l.value,"aria-valuemin":"0","aria-valuemax":"100"},c(l.value)+"% ",13,z)])])):g("",!0)])]),h.value?(p(),m("div",D,[a("a",{href:e.route("admin.imports.index"),class:"list-group-item list-group-item-action"}," Importar músicas (Admin) ",8,E)])):g("",!0)])]),_:1})])],64)}}};export{L as default};
