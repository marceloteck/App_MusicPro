import{_ as Y,r as ss,m as p,c as u,d as o,t as c,g as m,D as ts,v as $,j as L,h as z,F as g,l as y,B,o as d}from"./app-7df99663.js";const es={class:"topbar"},os={class:"pill"},ns={class:"pill"},ls={class:"pill"},as={class:"pill"},rs={class:"pill"},is={class:"header"},cs={class:"title"},us={class:"subtitle"},ds={class:"badge"},ps={class:"badge"},hs={class:"badge"},vs={class:"content"},ms={key:0,class:"divider"},fs={key:1,class:"music-line"},bs={class:"chord"},gs={class:"lyric"},ys={class:"footer"},xs={__name:"Musica",props:{musica:{type:Object,required:!0}},setup(G){const i=G,l=ss({fontSize:18,transpose:0,capoEnabled:!1,capoFret:0,chordColor:"#3fb6ff",boldChord:!0,boldLyric:!1}),x=p(()=>{var t,s,e,n;return Array.isArray((t=i.musica)==null?void 0:t.lyrics)?i.musica.lyrics.join(`
`):typeof((s=i.musica)==null?void 0:s.lyrics)=="string"?i.musica.lyrics:Array.isArray((e=i.musica)==null?void 0:e.letra)?i.musica.letra.join(`
`):((n=i.musica)==null?void 0:n.texto)??""}),D=p(()=>{var t,s;return((t=i.musica)==null?void 0:t.title)??((s=i.musica)==null?void 0:s.titulo)??"Cifra"}),H=p(()=>{var t,s;return((t=i.musica)==null?void 0:t.artist)??((s=i.musica)==null?void 0:s.artista)??""}),C=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],_=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],k=(t,s)=>(t%s+s)%s,N=t=>/[A-G]b/.test(t),A=t=>{const s=C.indexOf(t);return s!==-1?s:_.indexOf(t)},F=(t,s)=>s?_[t]:C[t],V=(t,s,e)=>{const n=/^([A-G])([#b]?)(.*?)(?:\/([A-G])([#b]?)(.*))?$/,a=t.match(n);if(!a)return t;const r=a[1]+(a[2]||""),h=a[3]||"",v=a[4]?a[4]+(a[5]||""):null,E=a[6]||"",T=A(r);if(T===null)return t;const b=F(k(T+s,12),e);if(v){const w=A(v);if(w===null)return`${b}${h}/${v}${E}`;const X=F(k(w+s,12),e);return`${b}${h}/${X}${E}`}return`${b}${h}`},M=t=>/^[A-G](#|b)?([a-zA-Z]{0,5})?\d*(\([^)]+\))?(\/[A-G](#|b)?)?$/.test(t),O=t=>{const s=t.trim();if(!s||s.includes("[")&&s.includes("]"))return!1;const e=s.split(/\s+/).filter(Boolean);return e.length?e.filter(M).length>=Math.max(1,Math.ceil(e.length*.6)):!1},P=t=>{const s=[],e=/\S+/g;let n;for(;(n=e.exec(t))!==null;){const a=n[0];M(a)&&s.push({idx:n.index,chord:a})}return s},U=t=>{let s="";const e=[];let n=0;for(;n<t.length;){if(t[n]==="["){const a=t.indexOf("]",n+1);if(a!==-1){const r=t.slice(n+1,a).trim();r&&e.push({idx:s.length,chord:r}),n=a+1;continue}}s+=t[n],n+=1}return{lyric:s,chords:e}},f=(t,s)=>{const e=s.length?Math.max(...s.map(r=>r.idx)):0,n=Math.max(t.length,e+1),a=new Map;return s.forEach(r=>a.set(r.idx,r.chord)),{lyric:t.padEnd(n," "),chordAt:a,len:n}},I=p(()=>{const t=x.value.replace(/\r\n/g,`
`).split(`
`),s=[];for(let e=0;e<t.length;e+=1){const n=t[e];if(O(n)&&e+1<t.length){const a=P(n),r=t[e+1];s.push({type:"music",model:f(r,a)}),e+=1;continue}if(n.includes("[")&&n.includes("]")){const{lyric:a,chords:r}=U(n);s.push({type:"music",model:f(a,r)});continue}if(!n.trim()){s.push({type:"divider"});continue}s.push({type:"music",model:f(n,[])})}return s}),j=p(()=>{const n=l.value.fontSize*1.8;return Math.max(1,Math.floor((1123-120-36-80)/n))}),S=p(()=>{const t=j.value,s=[];let e=[];return I.value.forEach(n=>{e.push(n),e.length>=t&&(s.push(e),e=[])}),e.length&&s.push(e),s}),R=p(()=>l.value.capoEnabled?l.value.transpose-l.value.capoFret:l.value.transpose),W=p(()=>N(x.value)),q=t=>{const s=[];for(let e=0;e<t.len;e+=1){const n=t.chordAt.get(e)||"";s.push({char:t.lyric[e]??" ",chord:n?V(n,R.value,W.value):""})}return s},Z=()=>{l.value.fontSize=Math.min(46,l.value.fontSize+2)},J=()=>{l.value.fontSize=Math.max(10,l.value.fontSize-2)},K=()=>{l.value.transpose=Math.min(24,l.value.transpose+1)},Q=()=>{l.value.transpose=Math.max(-24,l.value.transpose-1)};return(t,s)=>(d(),u("div",{class:"cifra-viewer",style:B({"--chordColor":l.value.chordColor,"--chordWeight":l.value.boldChord?800:600,"--lyricWeight":l.value.boldLyric?700:400})},[o("div",es,[o("button",{class:"btn",onClick:J},"A-"),o("button",{class:"btn",onClick:Z},"A+"),o("div",os,[s[6]||(s[6]=o("span",{class:"label"},"Fonte",-1)),o("b",null,c(l.value.fontSize)+"px",1)]),o("div",ns,[s[7]||(s[7]=o("span",{class:"label"},"Tom",-1)),o("button",{class:"btn",onClick:Q},"-"),o("b",null,c(l.value.transpose),1),o("button",{class:"btn",onClick:K},"+"),s[8]||(s[8]=o("span",{class:"helper"},"(semitons)",-1))]),o("div",ls,[s[10]||(s[10]=o("span",{class:"label"},"Capotraste",-1)),m(o("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>l.value.capoEnabled=e)},s[9]||(s[9]=[o("option",{value:!1},"Não",-1),o("option",{value:!0},"Sim",-1)]),512),[[ts,l.value.capoEnabled]]),s[11]||(s[11]=o("span",{class:"label"},"Traste",-1)),m(o("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>l.value.capoFret=e),type:"number",min:"0",max:"12"},null,512),[[$,l.value.capoFret,void 0,{number:!0}]])]),o("div",as,[s[12]||(s[12]=o("span",{class:"label"},"Cor da cifra",-1)),m(o("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>l.value.chordColor=e),type:"color"},null,512),[[$,l.value.chordColor]])]),o("div",rs,[s[15]||(s[15]=o("span",{class:"label"},"Negrito",-1)),o("label",null,[m(o("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>l.value.boldChord=e),type:"checkbox"},null,512),[[L,l.value.boldChord]]),s[13]||(s[13]=z(" Cifra "))]),o("label",null,[m(o("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>l.value.boldLyric=e),type:"checkbox"},null,512),[[L,l.value.boldLyric]]),s[14]||(s[14]=z(" Letra "))])]),o("button",{class:"btn",onClick:s[5]||(s[5]=()=>t.window.print())},"Imprimir")]),o("div",{class:"pages-wrap",style:B({"--fs":`${l.value.fontSize}px`})},[(d(!0),u(g,null,y(S.value,(e,n)=>(d(),u("div",{key:n,class:"page"},[o("div",is,[o("p",cs,c(D.value),1),o("p",us,[o("span",ds,c(H.value),1),o("span",ps,"Transposição: "+c(l.value.transpose),1),o("span",hs,"Capotraste: "+c(l.value.capoEnabled?l.value.capoFret:"Não"),1)])]),o("div",vs,[(d(!0),u(g,null,y(e,(a,r)=>(d(),u("div",{key:r,class:"line-wrapper"},[a.type==="divider"?(d(),u("div",ms)):(d(),u("div",fs,[(d(!0),u(g,null,y(q(a.model),(h,v)=>(d(),u("span",{key:v,class:"cell"},[o("span",bs,c(h.chord),1),o("span",gs,c(h.char),1)]))),128))]))]))),128))]),o("div",ys,"Página "+c(n+1)+" / "+c(S.value.length),1)]))),128))],4)],4))}},_s=Y(xs,[["__scopeId","data-v-c5c30c44"]]);export{_s as default};
